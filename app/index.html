<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv='X-UA-Compatible' content='IE=edge' />
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
    <title>Query Health Data</title>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
	<!-- jQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" language="javascript"  src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <!-- Required JS files to enable this page to embed within an MPage -->
    <!--
      Temporarily disable cerner-smart-embeddable-lib
      <script src='https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.min.js'></script>
      <script src='./lib/js/cerner-smart-embeddable-lib-1.0.0.min.js'></script>
    -->

    <!-- Application-level javascript-->
    <script src='./src/js/validateDate.js'></script>
    <script src='./src/js/query.js'></script>

    <!-- FHIR Client JS Library -->
    <script src='./lib/js/fhir-client-v0.1.12.js'></script>
    <!-- Prevent session bleed caused by single threaded embedded browser and sessionStorage API -->
        <!-- https://github.com/cerner/fhir-client-cerner-additions -->
    <script src='./lib/js/fhir-client-cerner-additions-1.0.0.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <script src='./lib/fhir-client.js'></script>
    <!-- <script src="js/query.js"></script> -->
</head>
<body>
<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="index.html">Patient-Generated Health Data Platform</a>
        </div>
    </div>
</nav>

<div class="row" id='loading'>
    <div class="col-md-6 col-md-offset-3">
        <div class="panel panel-default">
            <div class="panel-heading">Query Constraints</div>
            <div class="panel-body">
                <div class="form-group">
                    <label for="start">Start Time:</label>
                    <input type="text" class="form-control" id="start" placeholder="mm/dd/yyyy">
                </div>
                <div class="form-group">
                    <label for="end">End Time:</label>
                    <input type="text" class="form-control" id="end" placeholder="mm/dd/yyyy">
                </div>
                <div class="form-group">
                    <!-- <button class="btn btn-lg btn-primary btn-block" onClick="checkInputValidation(); extractData().then(function(p) {drawVisualization(p);});">Submit</button> -->
                    <button class="btn btn-lg btn-primary btn-block" onClick="validateAndSearch();">Submit</button>
                </div>
            </div>
        </div>
    </div>
</div>


    <div id='holder' style="display:none">
      <!-- toggle(holder) -->
      <h2>Patient-Generated-Health-Data APP</h2>

      <h2>Heart Rate Search Results</h2>

      <table id='query_table' width="600" border='2' align="center" class="table table-bordered table-striped table-hover">
      <thead class="thead-light">
        <tr>
          <th>DateTime </th>
          <th>Heart Rate: (/bpm)</th>
        </tr>
      </thead>

        <!-- <tr class = "info"> -->
          <!-- <th>Heart Rate: (/bpm)</th> -->
          <!-- <td id='time'></td> -->
          <!-- <td id='heart_rate'></td> -->
        <!-- </tr> -->

        <tbody class = "info">

        </tbody>

      </table>

    </div>


<div class="img-fluid">
	    <div class="footer-images">
			<img class="img-responsive mx-auto d-block" src="img/logo.png" alt="logo"  style="position:absolute;bottom:0;" >
		</div>
</div>

<script>
      function validateAndSearch() {
        validate();

        extractData().then(
          //Display Patient Demographics and Observations if extractData was success
          function(p) {
            drawVisualization(p);
          },

          //Display 'Failed to call FHIR Service' if extractData failed
          function() {
            $('#loading').hide();
            $('#errors').html('<p> Failed to call FHIR Service </p>');
          }
        );

      }

    </script>

  </body>
</html>
